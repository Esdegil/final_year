<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Interactive Chess Board: ESP32 Addressable LED Strip Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Interactive Chess Board
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ESP32 Addressable LED Strip Library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md37"></a>
Description</h1>
<p>This library can be used to drive addressable LED strips from the ESP32 using the RMT peripheral. This allows the RMT peripheral to handle all of the transmission while the processor is free to support other tasks.</p>
<p>The library currently uses double buffering to seperate the LED strip that's being currently displayed and the LED strip that is currently being updated. There are two buffers, 1 and 2, which contain the colors for the LED strip. When the driver is showing buffer 1, any calls to led_strip_set_pixel_color will update buffer 2. When a call to led_strip_show is made, it will switch out the buffers, so buffer 2 is currently being displayed and buffer 1 is the one that is written to when calls to led_strip_set_pixel_color are made.</p>
<h1><a class="anchor" id="autotoc_md38"></a>
How to use</h1>
<p>All functions for initializing and setting colors are located in <a class="el" href="led__strip_8h_source.html">led_strip.h</a>. Right now the library supports:</p>
<p>Initialization of an led strip which initializes the RMT peripheral and starts a task for driving LEDs </p><div class="fragment"><div class="line"><span class="keywordtype">bool</span> led_strip_init(<span class="keyword">struct</span> <a class="code" href="structled__strip__t.html">led_strip_t</a> *led_strip);</div>
</div><!-- fragment --><p>Setting individual led colors on an LED strip </p><div class="fragment"><div class="line"><span class="keywordtype">bool</span> led_strip_set_pixel_color(<span class="keyword">struct</span> <a class="code" href="structled__strip__t.html">led_strip_t</a> *led_strip, uint32_t pixel_num, <span class="keyword">struct</span> <a class="code" href="structled__color__t.html">led_color_t</a> *color);</div>
<div class="line"><span class="keywordtype">bool</span> led_strip_set_pixel_rgb(<span class="keyword">struct</span> <a class="code" href="structled__strip__t.html">led_strip_t</a> *led_strip, uint32_t pixel_num, uint8_t red, uint8_t green, uint8_t blue);</div>
</div><!-- fragment --><p>Updates the LED strip being shown. This switches the buffer currently being used to display the LED strips </p><div class="fragment"><div class="line"><span class="keywordtype">bool</span> led_strip_show(<span class="keyword">struct</span> <a class="code" href="structled__strip__t.html">led_strip_t</a> *led_strip);</div>
</div><!-- fragment --><p>Get the color of a pixel on the strip <b>currently being shown</b>. For instance, if you want to update the color of the led strip based on the color that's currently being shown, use this function. </p><div class="fragment"><div class="line"><span class="keywordtype">bool</span> led_strip_get_pixel_color(<span class="keyword">struct</span> <a class="code" href="structled__strip__t.html">led_strip_t</a> *led_strip, uint32_t pixel_num, <span class="keyword">struct</span> <a class="code" href="structled__color__t.html">led_color_t</a> *color);</div>
</div><!-- fragment --><p>Clear the led strip </p><div class="fragment"><div class="line"><span class="keywordtype">bool</span> led_strip_clear(<span class="keyword">struct</span> <a class="code" href="structled__strip__t.html">led_strip_t</a> *led_strip)</div>
</div><!-- fragment --><p>Below is simple configuration </p><div class="fragment"><div class="line"><span class="preprocessor">#define LED_STRIP_LENGTH 17U</span></div>
<div class="line"><span class="preprocessor">#define LED_STRIP_RMT_INTR_NUM 19U</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structled__color__t.html">led_color_t</a> led_strip_buf_1[LED_STRIP_LENGTH];</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structled__color__t.html">led_color_t</a> led_strip_buf_2[LED_STRIP_LENGTH];</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a class="code" href="structled__strip__t.html">led_strip_t</a> led_strip = {</div>
<div class="line">    .rgb_led_type = RGB_LED_TYPE_WS2812,</div>
<div class="line">    .rmt_channel = RMT_CHANNEL_1,</div>
<div class="line">    .rmt_interrupt_num = LED_STRIP_RMT_INTR_NUM,</div>
<div class="line">    .gpio = GPIO_NUM_21,</div>
<div class="line">    .led_strip_buf_1 = led_strip_buf_1,</div>
<div class="line">    .led_strip_buf_2 = led_strip_buf_2,</div>
<div class="line">    .led_strip_length = LED_STRIP_LENGTH</div>
<div class="line">};</div>
<div class="line">led_strip.access_semaphore = xSemaphoreCreateBinary();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> led_init_ok = led_strip_init(&amp;led_strip);</div>
</div><!-- fragment --><p>Expect more examples in main.c in the near future for use cases excercising all functionality of the library.</p>
<h1><a class="anchor" id="autotoc_md39"></a>
Limitations</h1>
<ol type="1">
<li>Right now the library only supports the timing for WS2812/WS2812B LED strips. I believe most of the Adafruit Neopixel strips use these LED drivers. The ability to add drivers for other LEDs like the SK6812 and WS2811 is implemented, but I don't have any to test on.</li>
<li>Only supports 30ms refresh period. Will add functionality to make this configurable in the future.</li>
</ol>
<h1><a class="anchor" id="autotoc_md40"></a>
Future Goals of Library (in somewhat prioritized order)</h1>
<ol type="1">
<li>Add higher level functions for generating rainbows, bouncing effects, etc.</li>
<li>Somehow clean up led strip c file. This may involve seperating the waveform generation of each kind of LED.</li>
<li>Add support for "LED rooms". An LED room may contain one or more strips covering multiple walls and multiple corners. This would allow very cool LED shows for different setups, such as LEDs bouncing off walls, LEDs mirroring what the other strip is doing parallel or perpendicular to it, etc.</li>
<li>Add support for other LED strips (WS2811, SK6812, etc.)</li>
<li>Add ESP supported logging and ESP checks at the beginning and end of function</li>
<li>Add notes about memory limitations. Right now depending on how its done, there are two buffers that are either stack allocated or statically allocated and another buffer for the rmt items that's malloc'd on the heap. </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="astructled__strip__t_html"><div class="ttname"><a href="structled__strip__t.html">led_strip_t</a></div><div class="ttdef"><b>Definition:</b> led_strip.h:44</div></div>
<div class="ttc" id="astructled__color__t_html"><div class="ttname"><a href="structled__color__t.html">led_color_t</a></div><div class="ttdef"><b>Definition:</b> led_strip.h:38</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
